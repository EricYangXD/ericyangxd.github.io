<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack知识点 | 木易的OT</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script>
        (function() {
          if (location.href.indexOf('github.io') > -1 || location.href.indexOf('gitee.io') > -1) {
             location.href = 'https://ericyangxd.top'
           }
        })();
        </script><script type='application/ld+json'>
          {
            "@context": "https://schema.org",
            "@type": "Article",
            "headline": "Webpack知识点",
            "url": "https://ericyangxd.top/handbook/Webpack/Basic.html",
            "image": [
              "https://ericyangxd.top/logo.png"
              ],
            "datePublished": "2022-02-10T00:00:00.000Z",
            "dateModified": "2023-03-13T00:00:00.000Z",
            "author": [{
                "@type": "Person",
                "name": "EricYangXD",
                "url": "https://github.com/EricYangXD/ericyangxd.github.io"
            }]
          }
      </script>
    <meta name="description" content="前端面试,React,Vue,JavaScript,CSS,HTML,HTTP,HTTPS,websocket,UDP,TCP,Webpack,算法,数据结构,LeetCode,小程序,油猴,计算机网络,NodeJs,Vite,Antdesign,EricYangXD,Eric,Chrome,Android,V8,Mac,git,网络安全,开发技巧,路由,router,诗歌,金句,源码,面试,Docker,Shell,clash,Windows">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="keywords" content="前端面试,React,Vue,JavaScript,CSS,HTML,HTTP,TCP,Webpack,算法,数据结构,LeetCode,小程序,油猴,计算机网络,NodeJs,Vite,Antdesign,EricYangXD,Eric,Chrome,Android,V8,Mac,git,网络安全,开发技巧,路由,router,话费,充值,诗歌,金句,源码,面试,docker">
    
    <link rel="preload" href="/assets/css/0.styles.82c89da6.css" as="style"><link rel="preload" href="/assets/js/app.824242fd.js" as="script"><link rel="preload" href="/assets/js/4.e4331d91.js" as="script"><link rel="preload" href="/assets/js/3.561be8e5.js" as="script"><link rel="preload" href="/assets/js/2.b25d4684.js" as="script"><link rel="preload" href="/assets/js/1.c7cb60d4.js" as="script"><link rel="preload" href="/assets/js/130.f4438d93.js" as="script"><link rel="prefetch" href="/assets/js/10.26f8cbb6.js"><link rel="prefetch" href="/assets/js/100.e0b47fab.js"><link rel="prefetch" href="/assets/js/101.4e95b0f8.js"><link rel="prefetch" href="/assets/js/102.0d30d461.js"><link rel="prefetch" href="/assets/js/103.1b687e4f.js"><link rel="prefetch" href="/assets/js/104.a46401a8.js"><link rel="prefetch" href="/assets/js/105.44fb88b2.js"><link rel="prefetch" href="/assets/js/106.021e8244.js"><link rel="prefetch" href="/assets/js/107.5bb22d6c.js"><link rel="prefetch" href="/assets/js/108.ba6415d7.js"><link rel="prefetch" href="/assets/js/109.e944ec08.js"><link rel="prefetch" href="/assets/js/11.ec88ce3f.js"><link rel="prefetch" href="/assets/js/110.5133f5e6.js"><link rel="prefetch" href="/assets/js/111.89dc6e02.js"><link rel="prefetch" href="/assets/js/112.0b2ba137.js"><link rel="prefetch" href="/assets/js/113.fdea453f.js"><link rel="prefetch" href="/assets/js/114.b6b4e348.js"><link rel="prefetch" href="/assets/js/115.202796a5.js"><link rel="prefetch" href="/assets/js/116.64c9baa9.js"><link rel="prefetch" href="/assets/js/117.6d598f88.js"><link rel="prefetch" href="/assets/js/118.89a70887.js"><link rel="prefetch" href="/assets/js/119.1f86941b.js"><link rel="prefetch" href="/assets/js/120.3dd53c9d.js"><link rel="prefetch" href="/assets/js/121.bf318a04.js"><link rel="prefetch" href="/assets/js/122.a8c0bd78.js"><link rel="prefetch" href="/assets/js/123.fb4320e0.js"><link rel="prefetch" href="/assets/js/124.dec9e24e.js"><link rel="prefetch" href="/assets/js/125.fa2fe9f6.js"><link rel="prefetch" href="/assets/js/126.c5c17b4e.js"><link rel="prefetch" href="/assets/js/127.51f16691.js"><link rel="prefetch" href="/assets/js/128.71d7e197.js"><link rel="prefetch" href="/assets/js/129.3a56e408.js"><link rel="prefetch" href="/assets/js/131.21bdf818.js"><link rel="prefetch" href="/assets/js/132.590acf7d.js"><link rel="prefetch" href="/assets/js/133.14c573d0.js"><link rel="prefetch" href="/assets/js/14.bad00e5b.js"><link rel="prefetch" href="/assets/js/15.b8e5af0a.js"><link rel="prefetch" href="/assets/js/16.ed296b89.js"><link rel="prefetch" href="/assets/js/17.d9e3ba74.js"><link rel="prefetch" href="/assets/js/18.8ddab221.js"><link rel="prefetch" href="/assets/js/19.57a74dfb.js"><link rel="prefetch" href="/assets/js/20.e3da0919.js"><link rel="prefetch" href="/assets/js/21.546b406c.js"><link rel="prefetch" href="/assets/js/22.9450f156.js"><link rel="prefetch" href="/assets/js/23.c854b682.js"><link rel="prefetch" href="/assets/js/24.877c6c49.js"><link rel="prefetch" href="/assets/js/25.1110b637.js"><link rel="prefetch" href="/assets/js/26.3f26d858.js"><link rel="prefetch" href="/assets/js/27.533548d8.js"><link rel="prefetch" href="/assets/js/28.98a340e2.js"><link rel="prefetch" href="/assets/js/29.edf59bdf.js"><link rel="prefetch" href="/assets/js/30.b7cf2b52.js"><link rel="prefetch" href="/assets/js/31.1fe66269.js"><link rel="prefetch" href="/assets/js/32.e46a6d14.js"><link rel="prefetch" href="/assets/js/33.db6ae149.js"><link rel="prefetch" href="/assets/js/34.66c83798.js"><link rel="prefetch" href="/assets/js/35.1f8028c0.js"><link rel="prefetch" href="/assets/js/36.86d9fc47.js"><link rel="prefetch" href="/assets/js/37.c2037205.js"><link rel="prefetch" href="/assets/js/38.334016b8.js"><link rel="prefetch" href="/assets/js/39.a4f75b3a.js"><link rel="prefetch" href="/assets/js/40.89908c21.js"><link rel="prefetch" href="/assets/js/41.2ba2c453.js"><link rel="prefetch" href="/assets/js/42.f70f4f9a.js"><link rel="prefetch" href="/assets/js/43.9ef740ec.js"><link rel="prefetch" href="/assets/js/44.a677bd37.js"><link rel="prefetch" href="/assets/js/45.b5f8c186.js"><link rel="prefetch" href="/assets/js/46.c79fd58b.js"><link rel="prefetch" href="/assets/js/47.b4bd4217.js"><link rel="prefetch" href="/assets/js/48.c340068e.js"><link rel="prefetch" href="/assets/js/49.0a3f6b91.js"><link rel="prefetch" href="/assets/js/5.41516153.js"><link rel="prefetch" href="/assets/js/50.d547e9f8.js"><link rel="prefetch" href="/assets/js/51.acdc1abe.js"><link rel="prefetch" href="/assets/js/52.50600936.js"><link rel="prefetch" href="/assets/js/53.6d507fec.js"><link rel="prefetch" href="/assets/js/54.59262359.js"><link rel="prefetch" href="/assets/js/55.47f58eae.js"><link rel="prefetch" href="/assets/js/56.710f08fd.js"><link rel="prefetch" href="/assets/js/57.640290e4.js"><link rel="prefetch" href="/assets/js/58.a8b538ec.js"><link rel="prefetch" href="/assets/js/59.5c8f1bc6.js"><link rel="prefetch" href="/assets/js/6.dca3a5c8.js"><link rel="prefetch" href="/assets/js/60.c0a81f17.js"><link rel="prefetch" href="/assets/js/61.a27e3f44.js"><link rel="prefetch" href="/assets/js/62.6cbb8d14.js"><link rel="prefetch" href="/assets/js/63.ac580b74.js"><link rel="prefetch" href="/assets/js/64.e563f145.js"><link rel="prefetch" href="/assets/js/65.ebae5779.js"><link rel="prefetch" href="/assets/js/66.5565eb64.js"><link rel="prefetch" href="/assets/js/67.88141eac.js"><link rel="prefetch" href="/assets/js/68.3a0ad599.js"><link rel="prefetch" href="/assets/js/69.3edca4b7.js"><link rel="prefetch" href="/assets/js/7.8f6e299c.js"><link rel="prefetch" href="/assets/js/70.a5543f2e.js"><link rel="prefetch" href="/assets/js/71.ccd7e2f2.js"><link rel="prefetch" href="/assets/js/72.023dfa73.js"><link rel="prefetch" href="/assets/js/73.87a3d508.js"><link rel="prefetch" href="/assets/js/74.b1af96c5.js"><link rel="prefetch" href="/assets/js/75.a67962d6.js"><link rel="prefetch" href="/assets/js/76.e42e2a81.js"><link rel="prefetch" href="/assets/js/77.3d1a7c23.js"><link rel="prefetch" href="/assets/js/78.9655f8b0.js"><link rel="prefetch" href="/assets/js/79.d1b91e67.js"><link rel="prefetch" href="/assets/js/8.41d4a20d.js"><link rel="prefetch" href="/assets/js/80.acb194bb.js"><link rel="prefetch" href="/assets/js/81.d7cecd71.js"><link rel="prefetch" href="/assets/js/82.ec4d1c90.js"><link rel="prefetch" href="/assets/js/83.271feaca.js"><link rel="prefetch" href="/assets/js/84.c38f6781.js"><link rel="prefetch" href="/assets/js/85.0c5c6c78.js"><link rel="prefetch" href="/assets/js/86.82b3e19e.js"><link rel="prefetch" href="/assets/js/87.e1b1adcc.js"><link rel="prefetch" href="/assets/js/88.8da69483.js"><link rel="prefetch" href="/assets/js/89.adfa0429.js"><link rel="prefetch" href="/assets/js/9.492c22f0.js"><link rel="prefetch" href="/assets/js/90.ab647d23.js"><link rel="prefetch" href="/assets/js/91.6fd66c60.js"><link rel="prefetch" href="/assets/js/92.e37a29fc.js"><link rel="prefetch" href="/assets/js/93.f8c70fe0.js"><link rel="prefetch" href="/assets/js/94.5ff3660d.js"><link rel="prefetch" href="/assets/js/95.a65f9967.js"><link rel="prefetch" href="/assets/js/96.23ad5cb3.js"><link rel="prefetch" href="/assets/js/97.e3d0a67c.js"><link rel="prefetch" href="/assets/js/98.c6ee1406.js"><link rel="prefetch" href="/assets/js/99.2a322d80.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.bd007aa5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82c89da6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-130b300a><div data-v-130b300a><div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-130b300a data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>木易的OT</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>前端面试,React,Vue,JavaScript,CSS,HTML,HTTP,HTTPS,websocket,UDP,TCP,Webpack,算法,数据结构,LeetCode,小程序,油猴,计算机网络,NodeJs,Vite,Antdesign,EricYangXD,Eric,Chrome,Android,V8,Mac,git,网络安全,开发技巧,路由,router,诗歌,金句,源码,面试,Docker,Shell,clash,Windows</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>EricYangXD</span>
            
          <!---->
          2024
        </a></span></div></div> <div class="hide" data-v-130b300a><header class="navbar" data-v-130b300a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">木易的OT</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      木易的OT
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/EricYangXD" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2295436007445021" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-130b300a></div> <aside class="sidebar" data-v-130b300a><div class="personal-info-wrapper" data-v-39576ba9 data-v-130b300a><!----> <h3 class="name" data-v-39576ba9>
    EricYangXD
  </h3> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>95</h3> <h6 data-v-39576ba9>文章</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>0</h3> <h6 data-v-39576ba9>标签</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      木易的OT
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/EricYangXD" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2295436007445021" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/" class="sidebar-heading clickable router-link-active"><span>About</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>LeetCode</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AntDesign</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Webpack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/handbook/Webpack/Basic.html" aria-current="page" class="active sidebar-link">Webpack基础知识</a></li><li><a href="/handbook/Webpack/Plugin-Loader.html" class="sidebar-link">常用插件和Loader</a></li><li><a href="/handbook/Webpack/Tree-Shaking.html" class="sidebar-link">Tree Shaking</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开发技巧</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Angular</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Backend（Java Based）</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>油猴</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vite</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Web安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Google Chrome V8</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mac使用记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>文章诗句</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Office软件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>股海沉浮</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>打工人须知</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>Webpack知识点</h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><span data-v-25ba6db2>EricYangXD</span>
            
          <!---->
          2024
        </a></span></div></div> <div data-v-130b300a><main class="page"><section><div class="page-title"><h1 class="title">Webpack知识点</h1> <div data-v-f875f3fc><i class="iconfont reco-account" data-v-f875f3fc><span data-v-f875f3fc>EricYangXD</span></i> <i class="iconfont reco-date" data-v-f875f3fc><span data-v-f875f3fc>2022/2/10</span></i> <i class="iconfont reco-eye" data-v-f875f3fc><span id="/handbook/Webpack/Basic.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-f875f3fc><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default"><h2 id="webpack5"><a href="#webpack5" class="header-anchor">#</a> Webpack5</h2> <p>Webpack 是目前最热门的前端工程化「模块打包工具」，它设计的初衷是「解决前端模块化问题」，让我们实现如何「高效的地管理和维护项目中的每一个资源」，目前最新版本 Webpack5，功能也变得越来越强大，但它依旧不忘初心，始终没有改变它是一个前端打包工具的初衷，它所做的事情就是：「分析项目结构，找到并加载所依赖的资源模块，把一些不被浏览器支持的特性（如 Sass，TypeScript，ES6+、JSX 等）转换和打包成浏览器兼容的格式来使用」。</p> <h3 id="资源模块"><a href="#资源模块" class="header-anchor">#</a> 资源模块</h3> <p>资源模块(asset module) 是一种模块类型，它允许在 js 代码中引入其它资源文件（字体，图片、样式等），以前只能通过 loader 加载器来实现，而 Webpack5 中通过 asset module 轻松实现。</p> <p>Webpack5 实现了 4 种新的模块类型，通过 Rule 的 type 属性设置：</p> <ol><li>asset/resource  输出一个单独的文件并导出 URL。之前通过使用  file-loader  实现。</li> <li>asset/inline  导出一个资源的 data URI。之前通过使用  url-loader  实现。</li> <li>asset/source  导出资源的源代码。之前通过使用  raw-loader  实现。</li> <li>asset  在导出一个 dataURI 和发送一个单独的文件之间自动选择。之前通过使用  url-loader，并且配置资源体积限制实现。</li></ol> <ul><li>如果设置成 asset/inline，则会把图片对应的 dataURI（base64 编码）写入到打包后的 js 文件中，这样的好处是减少页面的 http 请求数量，加快页面渲染速度。</li> <li>如果设置成 asset，则会根据图片的大小在 asset/inline 和 asset/resource 中自动选择</li> <li>默认大于 8KB 导出单独文件，小于等于 8KB 导出 dataURI（可通过 Rule 的 parser.dataUrlCondition.maxSize 去设置，单位是:Byte 字节）</li></ul> <h3 id="loader-和-plugin"><a href="#loader-和-plugin" class="header-anchor">#</a> loader 和 plugin</h3> <p>Loader 是用来解决资源文件的加载和编译问题，它只在模块加载环节工作。</p> <p>而 Plugin 就是用来处理 loader 工作以外的自动化工作：用来增加 Webpack 在项目自动化构建方面的能力，能作用于 Webpack 工作流程的方方面面，正是有了 Plugin，让 Webpack 几乎无所不能。</p> <h3 id="插件-plugin"><a href="#插件-plugin" class="header-anchor">#</a> 插件 (Plugin)</h3> <ul><li>自动生成所需的 html 文件</li> <li>实现打包前清除 dist 输出目录的内容</li> <li>拷贝不需要打包的资源文件到输出目录</li> <li>压缩 webpack 打包后的输出文件</li> <li>自动化部署</li></ul> <ol><li><code>html-webpack-plugin</code>：生成 html 文件并自动引入打包后的 js 文件。要生成多少个 html 文件就 new 多少个 Plugin。</li> <li><code>clean-webpack-plugin</code>：实现在打包前先清除之前生成的文件。webpack 5.20.0 以上版本只需要设置 output.clean 为 true 就行。</li> <li><code>copy-webpack-plugin</code>：在实际开发中还有很多不需要经过 webpack 构建的文件（如：favicon.ico、robots.txt 等），这些文件最终都需要部署到服务器，所以也需要放到最终的输出目录，可以通过该插件来实现复制，避免手动操作。</li></ol> <ul><li>Q:webpack 和 webpack 插件似乎“知道”应该生成哪些文件?</li> <li>A:答案是，webpack 通过 manifest，可以追踪所有模块到输出 bundle 之间的映射。通过 <code>WebpackManifestPlugin</code> 插件，可以将 manifest 数据提取为一个 json 文件以供使用。</li></ul> <h3 id="加载器-loader"><a href="#加载器-loader" class="header-anchor">#</a> 加载器（Loader）</h3> <p>webpack 使用加载器的顺序是从后往前调用。</p> <ol><li><code>css-loader</code>：处理项目中的样式文件，<code>css-loader</code>默认支持<code>*.module.css</code>格式的样式文件实现模块化，也就是说如果你的文件采用该命名方式，哪不配置<code>modules:true</code>，也能实现 css 模块化。</li> <li><code>style-loader</code>：把 css 代码写入页面 style 标签。</li> <li><code>css模块（css module）</code>：<code>css-loader</code>默认支持<code>*.module.css</code>格式的样式文件实现模块化。</li> <li><code>postcss-loader</code>：配合 <code>autoprefixer</code> 与 <code>browserslist</code> 自动添加浏览器内核前缀，从而实现样式兼容写法。
<ul><li>先安装加载器与依赖:<code>npm install postcss-loader autoprefixer</code></li> <li>配置 browserslist（可在<code>package.json</code>或<code>.browserslistrc</code>中配置）:<code>{&quot;browserslist&quot;: [&quot;last 2 versions&quot;,&quot;&gt; 1%&quot;,&quot;not IE 11&quot;]}</code></li> <li>webpack 配置:<code>options.postcssOptions.plugins=['autoprefixer']</code></li> <li>然后正常编写样式代码即可，打包时会自动加上前缀</li></ul></li> <li><code>sass-loader</code>：sass 加载器，该加载器依赖 sass 模块，所以需要一并安装：<code>npm install sass-loader sass</code>，并对<code>.scss</code>文件使用该 loader 即可。</li> <li><code>babel-loader</code>：使用 Babel 对 ES6+的新特性的代码进行转换，一般转换成 ES5 代码。先要安装 <code>babel-loader</code>，它需要依赖<code>@babel/core</code>：<code>npm install babel-loader @babel/core @babel/preset-env</code>。<code>@babel/preset-env</code>是用来解决浏览器兼容问题的预设，能根据当前的运行环境，自动确定你需要的 plugins 和 polyfills，强力推荐。对 js 文件设置<code>use:{loader:'babel-loader',options:{presets:['@babel/preset-env']}}</code>即可。</li></ol> <h2 id="详解-webpack-中的-hash、chunkhash、contenthash-区别"><a href="#详解-webpack-中的-hash、chunkhash、contenthash-区别" class="header-anchor">#</a> 详解 webpack 中的 hash、chunkhash、contenthash 区别</h2> <blockquote><p>hash 一般是结合 CDN 缓存来使用，通过 webpack 构建之后，生成对应文件名自动带上对应的 MD5 值。如果文件内容改变的话，那么对应文件哈希值也会改变，对应的 HTML 引用的 URL 地址也会改变，触发 CDN 服务器从源服务器上拉取对应数据，进而更新本地缓存。但是在实际使用的时候，这几种 hash 计算还是有一定区别。</p></blockquote> <h3 id="hash"><a href="#hash" class="header-anchor">#</a> hash</h3> <p>hash 是跟整个项目的构建相关，同一次构建过程中生成的哈希都是一样的，只要项目里有文件更改，整个项目构建的 hash 值都会更改，并且全部文件都共用相同的 hash 值。</p> <h3 id="chunkhash"><a href="#chunkhash" class="header-anchor">#</a> chunkhash</h3> <p>根据入口文件进行依赖文件解析、构建对应的 chunk，生成多个 bundle，把公共依赖库和我们的代码文件分开，但是如果某个文件变了，那么引用它的文件也会跟着改变。</p> <p>采用 hash 计算的话，每一次构建后生成的哈希值都不一样，即使文件内容压根没有改变。这样子是没办法实现缓存效果，我们需要换另一种哈希值计算方式，即 chunkhash。</p> <p>chunkhash 和 hash 不一样，它根据不同的入口文件(Entry)进行依赖文件解析、构建对应的 chunk，生成对应的哈希值。我们在生产环境里把一些公共库和程序入口文件区分开，单独打包构建，接着我们采用 chunkhash 的方式生成哈希值，那么只要我们不改动公共库的代码，就可以保证其哈希值不会受影响。</p> <h3 id="contenthash"><a href="#contenthash" class="header-anchor">#</a> contenthash</h3> <p>文件内容不改变，contenthash 就不变。</p> <p>在 chunkhash 的例子，我们可以看到由于 index.css 被 index.js 引用了，所以共用相同的 chunkhash 值。但是这样子有个问题，如果 index.js 更改了代码，css 文件就算内容没有任何改变，由于是该模块发生了改变，导致 css 文件会重复构建。</p> <p>这个时候，我们可以使用 extra-text-webpack-plugin 里的 contenthash 值，保证即使 css 文件所处的模块里就算其他文件内容改变，只要 css 文件内容不变，那么不会重复构建。</p> <p>一般用于 CDN。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 示例</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mini-css-extract-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 新增</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">chunk1</span><span class="token operator">:</span> <span class="token string">&quot;./src/chunk1.js&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name].[chunkhash].js&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token comment">// 新增</span>
		<span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">{</span>
				<span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 单个loader时可以直接 -&gt; loader:'css-loader'</span>
				<span class="token comment">// use: ['style-loader', &quot;css-loader&quot;], // 先使用css-loader，再使用style-loader</span>
				<span class="token comment">// 更多配置的时候使用对象的形式，简单配置的直接使用字符串即可</span>
				<span class="token comment">// use: [</span>
				<span class="token comment">// 	&quot;style-loader&quot;,</span>
				<span class="token comment">// 	{</span>
				<span class="token comment">// 		loader: &quot;css-loader&quot;,</span>
				<span class="token comment">// 		options: {</span>
				<span class="token comment">// 			modules: true,</span>
				<span class="token comment">// 		},</span>
				<span class="token comment">// 	},</span>
				<span class="token comment">// ],</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">{</span>
				<span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;url-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// webpack4</span>
				<span class="token comment">// webpack5</span>
				<span class="token comment">// type:'asset/resource', // 取代url-loader</span>
				<span class="token comment">// generator: {</span>
				<span class="token comment">// 	 filename: &quot;img/[name]-[hash][ext]&quot;,// 设置输出的文件名和保存的路径</span>
				<span class="token comment">// },</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token comment">// 新增</span>
		<span class="token comment">// 提取css插件</span>
		<span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			<span class="token comment">// Options similar to the same options in webpackOptions.output</span>
			<span class="token comment">// both options are optional</span>
			<span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name].[contenthash].css&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p>hash 所有文件哈希值相同； chunkhash 根据不同的入口文件(Entry)进行依赖文件解析、构建对应的 chunk，生成对应的哈希值； contenthash 计算与文件内容本身相关，主要用在 css 抽取 css 文件时。</p> <ol><li><strong>不管是在 chunkhash 还是 contenthash，修改 css 都会引发 js 和 css 的改变；</strong></li> <li><strong>在 chunkhash 时，由于 js 和 css 的 chunkhash 是一样的，所以修改了 js，会导致整个 chunk 的 chunkhash 改变，它们俩是同一个 chunkhash，肯定就都变了；而在 contenthash 时，js 修改不会影响 css 的改变。</strong></li></ol> <h2 id="hot-module-replacement-hmr-热模块替换"><a href="#hot-module-replacement-hmr-热模块替换" class="header-anchor">#</a> Hot Module Replacement(HMR)--热模块替换</h2> <p>见名思意，即无需刷新在内存环境中即可替换掉过旧模块。与 Live Reload 相对应。在 webpack 的运行时中 <code>__webpack__modules__</code> 用以维护所有的模块。</p> <p>而热模块替换的原理，即通过 chunk 的方式加载最新的 modules，找到 <code>__webpack__modules__</code> 中对应的模块逐一替换，并删除其上下缓存。</p> <ol><li><code>webpack-dev-server</code> 将打包输出 bundle 使用内存型文件系统控制，而非真实的文件系统。此时使用的是 memfs (opens new window)模拟 node.js fs API;</li> <li>每当文件发生变更时，webpack 将会重新编译，<code>webpack-dev-server</code> 将会监控到此时文件变更事件，并找到其对应的 module。此时使用的是 chokidar (opens new window)监控文件变更;</li> <li><code>webpack-dev-server</code> 将会把变更模块通知到浏览器端，此时使用 websocket 与浏览器进行交流。此时使用的是 ws(opens new window);</li> <li>浏览器根据 websocket 接收到 hash，并通过 hash 以 JSONP 的方式请求更新模块的 chunk;</li> <li>浏览器加载 chunk，并使用新的模块对旧模块进行热替换，并删除其缓存;</li></ol> <h2 id="如何提升-webpack-构建资源的速度"><a href="#如何提升-webpack-构建资源的速度" class="header-anchor">#</a> 如何提升 webpack 构建资源的速度</h2> <h3 id="更快的-loader-swc"><a href="#更快的-loader-swc" class="header-anchor">#</a> 更快的 loader: swc</h3> <p>在 webpack 中耗时最久的当属负责 AST 转换的 loader。当 loader 进行编译时的 AST 操作均为 CPU 密集型任务，使用 Javascript 性能低下，此时可采用高性能语言 rust 编写的 swc。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			<span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.m?js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
			<span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(node_modules)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
			<span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;swc-loader&quot;</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="持久化缓存-cache"><a href="#持久化缓存-cache" class="header-anchor">#</a> 持久化缓存: cache</h3> <ol><li><p>webpack5 内置了关于缓存的插件，可通过以下配置开启。它将 Module、Chunk、ModuleChunk 等信息序列化到磁盘中，二次构建避免重复编译计算，编译速度得到很大提升。</p></li> <li><p>如对一个 JS 文件配置了 eslint、typescript、babel 等 loader，他将有可能执行五次编译，被五次解析为 AST：</p></li></ol> <ul><li>acorn: 用以依赖分析，解析为 acorn 的 AST</li> <li><code>eslint-parser</code>: 用以 lint，解析为 espree 的 AST</li> <li>typescript: 用以 ts，解析为 typescript 的 AST</li> <li>babel: 用以转化为低版本，解析为 @babel/parser 的 AST</li> <li>terser: 用以压缩混淆，解析为 acorn 的 AST</li></ul> <p>而当开启了持久化缓存功能，最耗时的 AST 解析将能够从磁盘的缓存中获取，再次编译时无需再次进行解析 AST。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
	<span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;filesystem&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="3"><li>在 webpack4 中，可使用 cache-loader 仅仅对 loader 进行缓存。需要注意的是该 loader 目前已是 @depcrated 状态。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">{</span>
				<span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.ext$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;cache-loader&quot;</span><span class="token punctuation">,</span> <span class="token operator">...</span>loaders<span class="token punctuation">]</span><span class="token punctuation">,</span>
				<span class="token literal-property property">include</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="多进程-thread-loader"><a href="#多进程-thread-loader" class="header-anchor">#</a> 多进程: thread-loader</h3> <ol><li>thread-loader 为官方推荐的开启多进程的 loader，可对 babel 解析 AST 时开启多线程处理，提升编译的性能。</li> <li>把这个 loader 放置在其他 loader 之前，放置在这个 loader 之后的 loader 就会在一个单独的 worker 池(worker pool)中运行。</li> <li>每个 worker 都是一个单独的有 600ms 限制的 node.js 进程。同时跨进程的数据交换也会被限制。</li> <li>可以在 options 中配置 workers：即产生的 worker 的数量，默认是 cpu 的核心数；workerParallelJobs：一个 worker 进程中并行执行工作的数量，默认为 20；poolTimeout：闲置时定时删除 worker 进程，默认为 500ms；等参数。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">{</span>
				<span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
					<span class="token punctuation">{</span>
						<span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;thread-loader&quot;</span><span class="token punctuation">,</span>
						<span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
							<span class="token literal-property property">workers</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
						<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
				<span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ol start="2"><li>在 webpack4 中，可使用 happypack plugin，但需要注意的是 happypack 已经久不维护了。</li></ol> <h2 id="如何分析前端打包体积"><a href="#如何分析前端打包体积" class="header-anchor">#</a> 如何分析前端打包体积</h2> <p>在 webpack 中，可以使用 webpack-bundle-analyzer (opens new window)分析打包后体积分析。</p> <p>其原理是根据 webpack 打包后的 Stats (opens new window)数据进行分析，在 webpack compiler 的 done hook (opens new window)进行处理。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>done<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-bundle-analyzer&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在查看页面中，有三个体积选项：</p> <ul><li>stat: 每个模块的原始体积</li> <li>parsed: 每个模块经 webpack 打包处理之后的体积，比如 terser 等做了压缩，便会体现在上边</li> <li>gzip: 经 gzip 压缩后的体积</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ANALYZE=true npm run build 设置环境变量</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> BundleAnalyzerPlugin <span class="token operator">=</span>
	<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-bundle-analyzer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./index.js&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ANALYZE</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stat</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="如何正确地进行分包"><a href="#如何正确地进行分包" class="header-anchor">#</a> 如何正确地进行分包</h2> <h3 id="为什么需要分包"><a href="#为什么需要分包" class="header-anchor">#</a> 为什么需要分包？</h3> <ol><li>一行代码将导致整个 bundle.js 的缓存失效</li> <li>一个页面仅仅需要 bundle.js 中 1/N 的代码，剩下代码属于其它页面，完全没有必要加载</li></ol> <h3 id="如何更好的分包"><a href="#如何更好的分包" class="header-anchor">#</a> 如何更好的分包？</h3> <h4 id="打包工具运行时"><a href="#打包工具运行时" class="header-anchor">#</a> 打包工具运行时</h4> <p>webpack(或其他构建工具) 运行时代码不容易变更，需要单独抽离出来，比如 webpack.runtime.js。由于其体积小，必要时可注入 index.html 中，减少 HTTP 请求数，优化关键请求路径</p> <h4 id="前端框架运行时"><a href="#前端框架运行时" class="header-anchor">#</a> 前端框架运行时</h4> <p>React(Vue) 运行时代码不容易变更，且每个组件都会依赖它，可单独抽离出来 framework.runtime.js。请且注意，务必将 React 及其所有依赖(react-dom/object-assign)共同抽离出来，否则有可能造成性能损耗。(因 webpack 依赖其 object-assign，而 object-assign 将被打入共同依赖 vendor.chunk.js，因此此时它必回加载，但是该页面并不依赖任何第三方库，完全没有必要全部加载 vendor.chunk.js)</p> <h4 id="高频库"><a href="#高频库" class="header-anchor">#</a> 高频库</h4> <p>一个模块被 N(2 个以上) 个 Chunk 引用，可称为公共模块，可把公共模块给抽离出来，形成 vendor.js。</p> <ol><li>问：那如果一个模块被用了多次 (2 次以上)，但是该模块体积过大(1MB)，每个页面都会加载它(但是无必要，因为不是每个页面都依赖它)，导致性能变差，此时如何分包？</li></ol> <ul><li>答：如果一个模块虽是公共模块，但是该模块体积过大，可直接 import() 引入，异步加载，单独分包，比如 echarts 等</li></ul> <ol start="2"><li>问：如果公共模块数量多，导致 vendor.js 体积过大(1MB)，每个页面都会加载它，导致性能变差，此时如何分包</li></ol> <p>答：有以下两个思路</p> <ul><li>思路一: 可对 vendor.js 改变策略，比如被引用了十次以上，被当做公共模块抽离成 verdor-A.js，五次的抽离为 vendor-B.js，两次的抽离为 vendor-C.js</li> <li>思路二: 控制 vendor.js 的体积，当大于 100KB 时，再次进行分包，多分几个 vendor-XXX.js，但每个 vendor.js 都不超过 100KB</li></ul> <h4 id="使用-webpack-分包"><a href="#使用-webpack-分包" class="header-anchor">#</a> 使用 webpack 分包</h4> <ul><li>在 webpack 中可以使用 SplitChunksPlugin (opens new window)进行分包，它需要满足三个条件:</li></ul> <ol><li>minChunks: 一个模块是否最少被 minChunks 个 chunk 所引用</li> <li>maxInitialRequests/maxAsyncRequests: 最多只能有 maxInitialRequests/maxAsyncRequests 个 chunk 需要同时加载 (如一个 Chunk 依赖 VendorChunk 才可正常工作，此时同时加载 chunk 数为 2)</li> <li>minSize/maxSize: chunk 的体积必须介于 (minSize, maxSize) 之间</li></ol> <ul><li>以下是 next.js 的默认配置，可视作最佳实践: 源码位置: <a href="https://github.com/vercel/next.js/blob/v12.0.5-canary.10/packages/next/build/webpack-config.ts#L728" target="_blank" rel="nofollow noopener noreferrer">next/build/webpack-config.ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">// Keep main and _app chunks unsplitted in webpack 5</span>
  <span class="token comment">// as we don't need a separate vendor chunk from that</span>
  <span class="token comment">// and all other chunk depend on them so there is no</span>
  <span class="token comment">// duplication that need to be pulled out.</span>
  <span class="token function-variable function">chunks</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(polyfills|main|pages\/_app)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>chunk<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
    <span class="token operator">!</span><span class="token constant">MIDDLEWARE_ROUTE</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>chunk<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">framework</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">chunks</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">chunk</span><span class="token operator">:</span> webpack<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span>Chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token operator">!</span>chunk<span class="token punctuation">.</span>name<span class="token operator">?.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token constant">MIDDLEWARE_ROUTE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'framework'</span><span class="token punctuation">,</span>
      <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> resource <span class="token operator">=</span>
          module<span class="token punctuation">.</span>nameForCondition <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span><span class="token function">nameForCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>resource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> topLevelFrameworkPaths<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">packagePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          resource<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>packagePath<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
      <span class="token comment">// Don't let webpack eliminate this chunk (prevents this chunk from</span>
      <span class="token comment">// becoming a part of the commons chunk)</span>
      <span class="token literal-property property">enforce</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lib</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">test</span><span class="token punctuation">(</span>module<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">size</span><span class="token operator">:</span> Function
        <span class="token literal-property property">nameForCondition</span><span class="token operator">:</span> Function
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          module<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">160000</span> <span class="token operator">&amp;&amp;</span>
          <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules[/\\]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token function">nameForCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">name</span><span class="token punctuation">(</span>module<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> string
        libIdent<span class="token operator">?</span><span class="token operator">:</span> Function
        <span class="token function-variable function">updateHash</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">hash</span><span class="token operator">:</span> crypto<span class="token punctuation">.</span>Hash</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
        <span class="token keyword">const</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha1'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isModuleCSS</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          module<span class="token punctuation">.</span><span class="token function">updateHash</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>module<span class="token punctuation">.</span>libIdent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
              <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Encountered unknown module type: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>module<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. Please open an issue.</span><span class="token template-punctuation string">`</span></span>
            <span class="token punctuation">)</span>
          <span class="token punctuation">}</span>

          hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token function">libIdent</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">context</span><span class="token operator">:</span> dir <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
      <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">reuseExistingChunk</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">commons</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'commons'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">minChunks</span><span class="token operator">:</span> totalPages<span class="token punctuation">,</span>
      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">middleware</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">chunks</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">chunk</span><span class="token operator">:</span> webpack<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span>Chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        chunk<span class="token punctuation">.</span>name<span class="token operator">?.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token constant">MIDDLEWARE_ROUTE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'server/middleware-chunks/[name].js'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token literal-property property">enforce</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
  <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><h2 id="js-代码压缩-minify-的原理是什么"><a href="#js-代码压缩-minify-的原理是什么" class="header-anchor">#</a> JS 代码压缩 minify 的原理是什么</h2> <p>通过 AST 分析，根据选项配置一些策略，来生成一棵更小体积的 AST 并生成代码。</p> <p>目前前端工程化中使用 terser 和 swc 进行 JS 代码压缩，他们拥有相同的 API。</p> <p>常见用以压缩 AST 的几种方案如下:</p> <h3 id="去除多余字符-空格-换行及注释"><a href="#去除多余字符-空格-换行及注释" class="header-anchor">#</a> 去除多余字符: 空格，换行及注释</h3> <p>一般来说中文会占用更大的空间。多行代码压缩到一行时要注意行尾分号。</p> <h3 id="压缩变量名-变量名-函数名及属性名"><a href="#压缩变量名-变量名-函数名及属性名" class="header-anchor">#</a> 压缩变量名：变量名，函数名及属性名</h3> <p>缩短变量的命名也需要 AST 支持，不至于在作用域中造成命名冲突。</p> <h3 id="解析程序逻辑-合并声明以及布尔值简化"><a href="#解析程序逻辑-合并声明以及布尔值简化" class="header-anchor">#</a> 解析程序逻辑：合并声明以及布尔值简化</h3> <h3 id="解析程序逻辑-编译预计算"><a href="#解析程序逻辑-编译预计算" class="header-anchor">#</a> 解析程序逻辑: 编译预计算</h3> <p>在编译期进行计算，减少运行时的计算量。</p> <h2 id="_15-个-webpack-优化点"><a href="#_15-个-webpack-优化点" class="header-anchor">#</a> 15 个 Webpack 优化点</h2> <h3 id="构建时间的优化"><a href="#构建时间的优化" class="header-anchor">#</a> 构建时间的优化</h3> <h4 id="thread-loader"><a href="#thread-loader" class="header-anchor">#</a> thread-loader</h4> <p>多进程打包，可以大大提高构建的速度，使用方法是将 thread-loader 放在比较费时间的 loader 之前，比如 babel-loader，数组中右侧的 loader 先执行。</p> <h4 id="cache-loader"><a href="#cache-loader" class="header-anchor">#</a> cache-loader</h4> <p>缓存资源，提高二次构建的速度，使用方法是将 cache-loader 放在比较费时间的 loader 之前，比如 babel-loader，同上。</p> <h4 id="开启热更新"><a href="#开启热更新" class="header-anchor">#</a> 开启热更新</h4> <p>在 plugins 中增加 webpack 提供的热更新插件<code>new webpack.HotModuleReplacementPlugin()</code>，并配置<code>devServer.hot=true</code>。</p> <h4 id="合理设置-exclude-include"><a href="#合理设置-exclude-include" class="header-anchor">#</a> 合理设置 exclude &amp; include</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">//....</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  <span class="token comment">//使用include来指定编译文件夹</span>
  <span class="token literal-property property">include</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">//使用exclude排除指定文件夹</span>
  <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'babel-loader'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="构建区分环境"><a href="#构建区分环境" class="header-anchor">#</a> 构建区分环境</h4> <ol><li>开发环境：去除代码压缩、gzip、体积分析等优化的配置，大大提高构建速度</li> <li>生产环境：需要代码压缩、gzip、体积分析等优化的配置，大大降低最终项目打包体积</li></ol> <h4 id="提升-webpack-版本"><a href="#提升-webpack-版本" class="header-anchor">#</a> 提升 webpack 版本</h4> <h3 id="打包体积优化"><a href="#打包体积优化" class="header-anchor">#</a> 打包体积优化</h3> <p>主要是打包后项目整体体积的优化，有利于项目上线后的页面加载速度提升</p> <h4 id="css-代码压缩"><a href="#css-代码压缩" class="header-anchor">#</a> CSS 代码压缩</h4> <p>CSS 代码压缩使用<code>css-minimizer-webpack-plugin</code>，效果包括压缩、去重</p> <h4 id="js-代码压缩"><a href="#js-代码压缩" class="header-anchor">#</a> JS 代码压缩</h4> <ul><li>JS 代码压缩使用<code>terser-webpack-plugin</code>或者 uglify，实现打包后 JS 代码的压缩；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'css-minimizer-webpack-plugin'</span><span class="token punctuation">)</span>

  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 去重压缩css</span>
      <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 压缩JS代码</span>
        <span class="token literal-property property">terserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">drop_console</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 去除console</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 压缩JavaScript</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="tree-shaking"><a href="#tree-shaking" class="header-anchor">#</a> tree-shaking</h4> <p>tree-shaking 简单说作用就是：只打包用到的代码，没用到的代码不打包，而 webpack5 默认开启 tree-shaking，当打包的 mode 为 production 时，自动开启 tree-shaking 进行优化。</p> <h4 id="source-map-类型"><a href="#source-map-类型" class="header-anchor">#</a> source-map 类型</h4> <ul><li><p>source-map 的作用是：方便你报错的时候能定位到错误代码的位置。它的体积不容小觑，所以对于不同环境设置不同的类型是很有必要的。</p></li> <li><p>使用 <code>SourceMapDevToolPlugin</code> 进行更细粒度的配置。查看 <code>source-map-loader</code> 来处理已有的 source map。</p></li> <li><p>配置 devtool 来控制 source map。</p></li></ul> <ol><li>开发环境: <code>devtool: 'eval-cheap-module-source-map'</code>, 开发环境的时候我们需要能精准定位错误代码的位置</li> <li>生产环境: <code>devtool: 'nosources-source-map'</code>, 生产环境，我们想开启 source-map，但是又不想体积太大，那么可以换一种类型</li> <li>验证 devtool 名称时，我们期望使用某种模式，注意不要混淆 devtool 字符串的顺序，模式是：<code>[inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</code></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token string">&quot;(none)&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 生产包不配置devtool时，不生成 source map。性能最佳。build和rebuild速度都是最快的。具有最高性能的生产构建的推荐选择。缺点就是生产出了问题没法直接定位调试。</span>
	<span class="token string">&quot;eval&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 具有最高性能的开发构建的推荐选择。</span>
	<span class="token string">&quot;eval-cheap-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 开发构建的权衡选择。</span>
	<span class="token string">&quot;eval-cheap-module-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 开发构建的权衡选择。</span>
	<span class="token string">&quot;eval-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 使用高质量 SourceMap 进行开发构建的推荐选择。</span>
	<span class="token string">&quot;source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 具有高质量 SourceMap 的生产构建的推荐选择。</span>
	<span class="token string">&quot;cheap-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 没有列映射(column mapping)的 source map，忽略 loader source map。</span>
	<span class="token string">&quot;cheap-module-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 没有列映射(column mapping)的 source map，将 loader source map 简化为每行一个映射(mapping)。</span>
	<span class="token string">&quot;inline-cheap-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 类似 cheap-source-map，但是 source map 转换为 DataUrl 后添加到 bundle 中。</span>
	<span class="token string">&quot;inline-cheap-module-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 类似 cheap-module-source-map，但是 source map 转换为 DataUrl 添加到 bundle 中。</span>
	<span class="token string">&quot;inline-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 发布单个文件时的可能选择</span>
	<span class="token string">&quot;hidden-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 没有参考。仅将 SourceMap 用于错误报告目的时的可能选择。用于错误上报。</span>
	<span class="token string">&quot;nosources-source-map&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 不包括源代码</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="打包体积分析"><a href="#打包体积分析" class="header-anchor">#</a> 打包体积分析</h4> <p>使用<code>webpack-bundle-analyzer</code>插件可以审查打包后的体积分布，进而进行相应的体积优化</p> <h4 id="打包速度分析"><a href="#打包速度分析" class="header-anchor">#</a> 打包速度分析</h4> <p>使用<code>speed-measure-webpack-plugin</code>插件可以审查打包后的体积分布，进而进行相应的体积优化</p> <h3 id="用户体验优化"><a href="#用户体验优化" class="header-anchor">#</a> 用户体验优化</h3> <h4 id="模块懒加载"><a href="#模块懒加载" class="header-anchor">#</a> 模块懒加载</h4> <p>如果不进行模块懒加载的话，最后整个项目代码都会被打包到一个 js 文件里，单个 js 文件体积非常大，那么当用户网页请求的时候，首屏加载时间会比较长，使用模块懒加载之后，大 js 文件会分成多个小 js 文件，网页加载时会按需加载，大大提升首屏加载速度。在配置路由时使用 lazy 动态 import 页面组件。</p> <h4 id="gzip"><a href="#gzip" class="header-anchor">#</a> Gzip</h4> <p>Gzip 的内核是 Deflate，目前我们压缩文件用得最多的就是 Gzip。</p> <p>使用<code>compression-webpack-plugin</code>，开启 Gzip 后，大大提高用户的页面加载速度，因为 gzip 的体积比原文件小很多，当然也需要后端的配合。</p> <ul><li>Gzip 是高效的，压缩后通常能帮我们减少响应 70% 左右的大小</li> <li>Gzip 并不保证针对每一个文件的压缩都会使其变小</li> <li>Gzip 压缩背后的原理，是在一个文本文件中找出一些重复出现的字符串、临时替换它们，从而使整个文件变小。根据这个原理，文件中代码的重复率越高，那么压缩的效率就越高，使用 Gzip 的收益也就越大。反之亦然。</li></ul> <ol><li>一般来说，Gzip 压缩是服务器的活。本质可以理解为我们以服务器压缩的时间开销和 CPU 开销（以及浏览器解析压缩文件的开销）为代价，省下了一些传输过程中的时间开销。</li> <li>服务器的 CPU 性能不是无限的，如果存在大量的压缩需求，服务器也扛不住的。服务器一旦因此慢下来了，用户还是要等。Webpack 中 Gzip 压缩操作的存在，事实上就是为了在构建过程中去做一部分服务器的工作，为服务器分压。</li> <li></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
	<span class="token comment">// ...</span>
	<span class="token comment">// gzip</span>
	<span class="token keyword">new</span> <span class="token class-name">CompressionPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">&quot;gzip&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">10240</span><span class="token punctuation">,</span>
		<span class="token literal-property property">minRatio</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 开启和关闭gzip模式</span>
<span class="token function">gzip</span> on<span class="token punctuation">;</span>
<span class="token comment"># gizp压缩起点，文件大于1k才进行压缩</span>
gzip_min_length 1k<span class="token punctuation">;</span>
<span class="token comment"># 设置压缩所需要的缓冲区大小，以4k为单位，如果文件为7k则申请2*4k的缓冲区</span>
gzip_buffers <span class="token number">4</span> 16k<span class="token punctuation">;</span>
<span class="token comment"># 设置gzip压缩针对的HTTP协议版本</span>
gzip_http_version <span class="token number">1.0</span><span class="token punctuation">;</span>
<span class="token comment"># gzip 压缩级别，1-9，数字越大压缩的越好，也越占用CPU时间</span>
gzip_comp_level <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment"># 进行压缩的文件类型</span>
gzip_types text/plain application/javascript text/css application/xml<span class="token punctuation">;</span>
<span class="token comment"># 是否在http header中添加Vary: Accept-Encoding，建议开启</span>
gzip_vary on<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="小图片转-base64"><a href="#小图片转-base64" class="header-anchor">#</a> 小图片转 base64</h4> <p>对于一些小图片，可以转 base64，这样可以减少用户的 http 网络请求次数，提高用户的体验。webpack5 中<code>url-loader</code>已被废弃，改用<code>asset-module</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
   <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg|webp)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
   <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
   <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token comment">// 转base64的条件</span>
     <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">25</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment">// 25kb</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token literal-property property">generator</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token comment">// 打包到 image 文件下</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'images/[contenthash][ext][query]'</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="合理配置-hash"><a href="#合理配置-hash" class="header-anchor">#</a> 合理配置 hash</h4> <p>我们要保证，改过的文件需要更新 hash 值，而没改过的文件依然保持原本的 hash 值，这样才能保证在上线后，浏览器访问时没有改变的文件会命中缓存，从而达到性能优化的目的。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 给js文件加上 contenthash</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'js/chunk-[contenthash].js'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="首屏优化之-cdn-加速"><a href="#首屏优化之-cdn-加速" class="header-anchor">#</a> 首屏优化之 CDN 加速</h4> <p>通过把类似 echart、element-ui、lodash 等第三方依赖库单独提取出，从而减小打包的体积大小，通过 chainWebpack 中配置 externals 属性后的依赖插件不会被打包进 chunk 。而使用 CDN 加速、缓存也能加快访问速度。</p> <ol><li>在 index.html 中手动引入 cdn 链接。并修改 webpack 配置，不再把 cdn 引入的依赖打包进 chunk。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">IS_PRO</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">//... 其他基本配置</span>
	<span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">IS_PRO</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			config<span class="token punctuation">.</span><span class="token function">externals</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">echarts</span><span class="token operator">:</span> <span class="token string">&quot;echarts&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="2"><li>通过 html-webpack-plugin 将 cdn 注入到 index.html 之中。需要修改 webpack 配置。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> cdn <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token literal-property property">js</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://cdn.jsdelivr.net/npm/echarts@4.8.0/dist/echarts.min.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 通过 html-webpack-plugin 将 cdn 注入到 index.html 之中</span>
config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">&quot;html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cdn <span class="token operator">=</span> cdn<span class="token punctuation">;</span>
	<span class="token keyword">return</span> args<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="首屏优化之代码分割-splitchunks-拆包优化"><a href="#首屏优化之代码分割-splitchunks-拆包优化" class="header-anchor">#</a> 首屏优化之代码分割-splitChunks 拆包优化</h4> <ol><li>Bundle Splitting: 这个过程提供了一种优化构建的方法，允许 webpack 为单个应用程序生成多个 bundle 文件。因此，可以将每个 bundle 文件与影响其他文件的更改进行分离，从而减少重新发布并由此被客户端重新下载的代码量，并且运用浏览器「缓存」。
<ul><li>拆分的越小，文件越多，可能会有更多 Webpack 的辅助代码，也会带来更少的合并压缩。但是，通过数据分析，文件拆分越多，性能会更好。</li></ul></li> <li>Code Splitting: 代码分离指将代码分成不同的包/块，然后可以「按需加载」，而不是加载包含所有内容的单个包。一般配合路由懒加载。通过 Webpack4 的 import()语法。</li></ol> <ul><li>webpack 默认配置下会把所有的依赖和插件都打包到 vendors.js 中，有些可能是 app.js 。所以，对于大量引入第三方依赖的项目，这个文件会非常的大。而对于在特定页面中才会使用的插件也会造成性能浪费。这时拆分和异步就显得尤为重要了。</li> <li>包的大小本地打包完成时可以看到，若想更仔细的分析可以通过插件 <code>webpack-bundle-analyzer</code>；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;async&quot;</span><span class="token punctuation">,</span><span class="token comment">// 哪些chunks需要进行优化，async-按需引入的模块将会被用于优化，initial-被直接引入的模块将会被用于优化，all-全部都会被用于优化。</span>
  <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span><span class="token comment">// 打包优化完生成的新chunk大小要&gt; 30000字节，否则不生成新chunk。</span>
  <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">// 共享该module的最小chunk数</span>
  <span class="token literal-property property">maxAsyncRequests</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token comment">// 最多有N个异步加载请求该module</span>
  <span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token comment">// 一个入口文件可以并行加载的最大文件数量</span>
  <span class="token literal-property property">automaticNameDelimiter</span><span class="token operator">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span><span class="token comment">// 名字中间的间隔符</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// chunk的名字，true-自动生成，false-由 id 决定，string-缓存组最终会打包成一个 chunk，名称就是该 string。</span>
  <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token comment">// 要切割成的每一个新chunk就是一个cache group。</span>
    <span class="token literal-property property">styles</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'style'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">test</span><span class="token operator">:</span> <span class="token parameter">m</span> <span class="token operator">=&gt;</span> m<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'CssModule'</span><span class="token punctuation">,</span><span class="token comment">// 用来决定提取哪些module，可以接受字符串，正则表达式，或者函数，函数的一个参数为module，第二个参数为引用这个module的chunk(数组)。</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">enforce</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">emcommon</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'emcommon'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">test</span><span class="token operator">:</span> <span class="token parameter">module</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> regs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@ant-design</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@em</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@bytedesign</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> regs<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">reg</span> <span class="token operator">=&gt;</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">enforce</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span><span class="token comment">// 优先级一样的话，size大的优先被选择。</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">byteedu</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'byteedu'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">test</span><span class="token operator">:</span> <span class="token parameter">module</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> regs <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@ax</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@bridge</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">axios</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">lodash</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@byted-edu</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">codemirror</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@syl-editor</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">prosemirror</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> regs<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">reg</span> <span class="token operator">=&gt;</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">enforce</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">reuseExistingChunk</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 当module未变时，是否可以使用之前的chunk。</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><h2 id="webpack-构建流程"><a href="#webpack-构建流程" class="header-anchor">#</a> webpack 构建流程</h2> <ol><li>通过 yargs 解析 config 和 shell 的配置项</li> <li>webpack 初始化过程，首先会根据第一步的 options 生成 compiler 对象，然后初始化 webpack 的内置插件及 options 配置</li> <li>run 代表编译的开始，会构建 compilation 对象，用于存储这一次编译过程的所有数据</li> <li>make 执行真正的编译构建过程，从入口文件开始，构建模块，直到所有模块创建结束</li> <li>seal 生成 chunks，对 chunks 进行一系列的优化操作，并生成要输出的代码</li> <li>seal 结束后，Compilation 实例的所有工作到此也全部结束，意味着一次构建过程已经结束</li></ol> <p>Webpack 插件统一以 apply 方法为入口，然后注册优化事件，apply 方法接收一个参数，该参数是 webpack 初始化过程中生成的 compiler 对象的引用，从而可以在回调函数中访问到 compiler 对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//Compiler 对象包含了 Webpack 环境的所有配置信息，包含options、loaders、plugins等信息。这个对象在 Webpack 启动时被实例化，它是全局唯一的，可以简单地将它理解为 Webpack 实例。</span>
  compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;SplitChunksPlugin&quot;</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//Compilation 对象包含了当前的模块资源、编译生成资源、变化的文件等。当 Webpack 以开发模式运行时，每当检测到一个文件变化，一次新的 Compilation 将被创建。Compilation 对象也提供了很多事件回调供插件做扩展。通过 Compilation 也能读取到 Compiler 对象。</span>
    <span class="token keyword">let</span> alreadyOptimized <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">//当编译开始接受新模块时触发</span>
    compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>unseal<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;SplitChunksPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      alreadyOptimized <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//在块优化阶段的开始时调用。插件可以利用此钩子来执行块优化。</span>
    compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>optimizeChunksAdvanced<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>
      <span class="token string">&quot;SplitChunksPlugin&quot;</span><span class="token punctuation">,</span>
      <span class="token parameter">chunks</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">//核心代码</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="开发工具"><a href="#开发工具" class="header-anchor">#</a> 开发工具</h2> <p>在每次编译代码时，手动运行 <code>npm run build</code> 会显得很麻烦。webpack 提供几种可选方式，帮助你在代码发生变化后自动编译代码：</p> <ol><li><code>webpack's Watch Mode</code></li> <li><code>webpack-dev-server</code></li> <li><code>webpack-dev-middleware</code></li></ol> <p>多数场景中，你可能需要使用 <code>webpack-dev-server</code>。</p> <h3 id="使用-watch-mode-观察模式"><a href="#使用-watch-mode-观察模式" class="header-anchor">#</a> 使用 watch mode(观察模式)</h3> <p>可以指示 webpack &quot;watch&quot; 依赖图中所有文件的更改。如果其中一个文件被更新，代码将被重新编译，所以你不必再去手动运行整个构建。唯一的缺点是，为了看到修改后的实际效果，你需要手动刷新浏览器。</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --watch&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="webpack-dev-server"><a href="#webpack-dev-server" class="header-anchor">#</a> webpack-dev-server</h3> <p>通过<strong>devServer</strong>能在本地开发环境创建一个服务器，该服务器基于<strong>express</strong>，它能实现当项目中的代码发生改变的时，除了打包编译外，还可以帮助我们自动刷新浏览器从而实现实时展示效果。</p> <ol><li>安装：<code>npm install webpack-dev-server</code></li> <li>安装后只需要在 webpack.config.js 配置文件中设置 devSever 属性即可，可以设置成一个空对象，因为 devServer 能实现零配置启动。</li> <li>零配置启动服务器，默认端口为 8080：<code>npx webpack-dev-server</code>或<code>npx webpack server</code></li> <li>服务器启动后，devServer 会监听着项目文件的变化，当文件有修改时自动重新打包编译，并采用 HMR 热替换或自动刷新浏览器方式更新页面效果。但与 watch 模式不同，webpack 为了让效率更快，这些打包操作并没生成具体的文件到磁盘中，而是在内存中完成的，所以我们并不会在实际的目录中看到打包后的文件效果。</li> <li>配置参数
<ul><li>static：指定静态资源目录（默认是 public 文件夹） 一般用来存放一些不经过 webpack 打包的静态资源文件（如：favicon.ico）</li> <li>port: 指定服务器端口（默认：8080）</li> <li>hot: 是热模块替换启用（默认：true）</li> <li>open: 是否自动打开浏览器（默认：false）</li> <li>historyApiFallback: 是否支持 history 路由（默认：false），可以设置访问页不存在时的默认跳转路径。</li> <li>host：默认情况下，只有本机才能访问 devServer 服务器，通过设置 host 为 0.0.0.0 让局域网其它设备也能访问</li> <li>compress: 启动 gzip 服务器压缩</li> <li>proxy: 服务器代理（一般用于解决 ajax 跨域问题），基于 http-proxy-middleware 的代理服务器</li> <li>默认情况下，代理时会保留主机头的来源（请求头中的 Origin 字段为<code>http://localhost:8090</code>），有的接口服务器可能会对 Origin 字符进行限制，我们可以将 changeOrigin 设置为 true 以覆盖此行为，设置后 Origin 字段就被覆盖为<code>http://127.0.0.1:8081</code>。</li></ul></li></ol> <ul><li><code>webpack-dev-server</code> 在编译之后不会写入到任何输出文件。而是将 bundle 文件保留在内存中，然后将它们 serve 到 server 中，就好像它们是挂载在 server 根路径上的真实文件一样。如果你的页面希望在其他不同路径中找到 bundle 文件，则可以通过 dev server 配置中的 devMiddleware.publicPath 选项进行修改。</li> <li><code>webpack-dev-server</code> 会从 <code>output.path</code> 中定义的目录中的 bundle 文件提供服务，即文件将可以通过 <code>http://[devServer.host]:[devServer.port]/[output.publicPath]/[output.filename]</code> 进行访问。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">print</span><span class="token operator">:</span> <span class="token string">&quot;./src/print.js&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">dependOn</span><span class="token operator">:</span> <span class="token string">&quot;shared&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 配置 dependOn option 选项，这样可以在多个 chunk 之间共享模块</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token literal-property property">another</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">&quot;./src/another-module.js&quot;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">dependOn</span><span class="token operator">:</span> <span class="token string">&quot;shared&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token string">&quot;lodash&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;Development&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;[name].bundle.js&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 在每次构建前清理 /dist 文件夹，这样只会生成用到的文件。</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&quot;inline-source-map&quot;</span><span class="token punctuation">,</span>
	<span class="token comment">//...</span>
	<span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token comment">// 4.x版本写法</span>
		<span class="token literal-property property">contentBase</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;./public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token comment">// 5.x版本写法</span>
		<span class="token keyword">static</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;./public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">8090</span><span class="token punctuation">,</span>
		<span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token comment">// historyApiFallback: true,</span>
		<span class="token literal-property property">historyApiFallback</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token literal-property property">rewrites</span><span class="token operator">:</span> <span class="token string">&quot;./404.html&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token string-property property">&quot;/api/search&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;http://127.0.0.1:8081&quot;</span><span class="token punctuation">,</span> <span class="token comment">// target表示代理的服务器url</span>
				<span class="token literal-property property">pathRewrite</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token comment">// pathRewrite表示路径重写，key表示一个正则，value表示别名</span>
					<span class="token string-property property">&quot;^/api&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/api&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 即用 '/api'表示'http://localhost:8081/api'</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">runtimeChunk</span><span class="token operator">:</span> <span class="token string">&quot;single&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 单个 HTML 页面有多个入口时，可以防止webpack在运行时创建同一模块的两个实例，同时减少为给定页面加载模块所需的 HTTP 请求数。</span>
		<span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 将公共的依赖模块提取到已有的入口 chunk 中，或者提取到一个新生成的 chunk。</span>
			<span class="token comment">// 将第三方库(library)（例如 lodash 或 react）提取到单独的 vendor chunk 文件中，是比较推荐的做法，这是因为，它们很少像本地的源代码那样频繁修改。因此通过实现以上步骤，利用 client 的长效缓存机制，命中缓存来消除请求，并减少向 server 获取资源，同时还能保证 client 代码和 server 代码版本一致。</span>
			<span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token literal-property property">vendor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;vendors&quot;</span><span class="token punctuation">,</span>
					<span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h3 id="使用-webpack-dev-middleware"><a href="#使用-webpack-dev-middleware" class="header-anchor">#</a> 使用 webpack-dev-middleware</h3> <p><code>webpack-dev-middleware</code> 是一个封装器(wrapper)，它可以把 webpack 处理过的文件发送到一个 server。<code>webpack-dev-server</code> 在内部使用了它，然而它也可以作为一个单独的 package 来使用，以便根据需求进行更多自定义设置。</p> <p>需要调整 webpack 配置文件，配置<code>output.publicPath='/'</code>，在 server 脚本使用 publicPath，以确保文件资源能够正确地 serve 在 <code>http://localhost:3000</code> 下。然后在根目录添加 server.js 文件，然后添加一个 npm script，以使我们更方便地运行 server：<code>&quot;server&quot;: &quot;node server.js&quot;</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackDevMiddleware <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-dev-middleware&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.config.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 告知 express 使用 webpack-dev-middleware，</span>
<span class="token comment">// 以及将 webpack.config.js 配置文件作为基础配置。</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
	<span class="token function">webpackDevMiddleware</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">publicPath</span><span class="token operator">:</span> config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>publicPath<span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将文件 serve 到 port 3000。</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Example app listening on port 3000!\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="多页应用和单页应用"><a href="#多页应用和单页应用" class="header-anchor">#</a> 多页应用和单页应用</h2> <ol><li>多页 MPA：指一个应用中有多个页面，页面跳转时是整页刷新。在多页面应用程序中，server 会拉取一个新的 HTML 文档给你的客户端。页面重新加载此新文档，并且资源被重新下载。由于入口起点数量的增多，多页应用能够复用多个入口起点之间的大量代码/模块（需要自行配置：例如使用 <code>optimization.splitChunks</code> 为页面间共享的应用程序代码创建 bundle）。</li> <li>所谓基于 webpack 实现多页面应用，简单来将就是基于多个 entry，将 js 代码分为多个 entry 入口文件。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">// 1.此时仅仅是根据这三条配置打成了三个chunk包：pageOne.js/pageTwo.js/pageThree.js</span>
	<span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token literal-property property">pageOne</span><span class="token operator">:</span> <span class="token string">&quot;./src/pageOne/index.js&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">pageTwo</span><span class="token operator">:</span> <span class="token string">&quot;./src/pageTwo/index.js&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">pageThree</span><span class="token operator">:</span> <span class="token string">&quot;./src/pageThree/index.js&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// 2.还要配合htmlWebpackPlugin，把上面的三个chunk分别生成到对应的html文件里，才算是实现多入口。要生成几个html就调几遍。</span>
	<span class="token comment">// 缺点是：如果只改动了其中一个chunk，其他chunk也要重新打包。</span>
	<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			<span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;pageOne.html&quot;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;pageOne&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token literal-property property">template</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../public/index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			<span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;pageTwo.html&quot;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;pageTwo&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token literal-property property">template</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../public/index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">htmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			<span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;pageThree.html&quot;</span><span class="token punctuation">,</span>
			<span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;pageThree&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token literal-property property">template</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../public/index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ol start="3"><li>单页 SPA：指只有一个主页面的应用，浏览器一开始要加载所有必须的 html, js, css。所有的页面内容都包含在这个所谓的主页面中。但在写的时候，还是会分开写（页面片段），然后在交互的时候由路由程序动态载入，单页面的页面跳转，仅刷新局部资源。</li></ol></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">3/13/2023</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/handbook/Applet/Taro.html" class="prev">
            小程序 &amp; Taro
          </a></span> <span class="next"><a href="/handbook/Webpack/Plugin-Loader.html">
            常用插件和Loader
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#webpack5" class="sidebar-link reco-side-webpack5" data-v-cb1513f6>Webpack5</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#资源模块" class="sidebar-link reco-side-资源模块" data-v-cb1513f6>资源模块</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#loader-和-plugin" class="sidebar-link reco-side-loader-和-plugin" data-v-cb1513f6>loader 和 plugin</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#插件-plugin" class="sidebar-link reco-side-插件-plugin" data-v-cb1513f6>插件 (Plugin)</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#加载器-loader" class="sidebar-link reco-side-加载器-loader" data-v-cb1513f6>加载器（Loader）</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#详解-webpack-中的-hash、chunkhash、contenthash-区别" class="sidebar-link reco-side-详解-webpack-中的-hash、chunkhash、contenthash-区别" data-v-cb1513f6>详解 webpack 中的 hash、chunkhash、contenthash 区别</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#hash" class="sidebar-link reco-side-hash" data-v-cb1513f6>hash</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#chunkhash" class="sidebar-link reco-side-chunkhash" data-v-cb1513f6>chunkhash</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#contenthash" class="sidebar-link reco-side-contenthash" data-v-cb1513f6>contenthash</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#总结" class="sidebar-link reco-side-总结" data-v-cb1513f6>总结</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#hot-module-replacement-hmr-热模块替换" class="sidebar-link reco-side-hot-module-replacement-hmr-热模块替换" data-v-cb1513f6>Hot Module Replacement(HMR)--热模块替换</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#如何提升-webpack-构建资源的速度" class="sidebar-link reco-side-如何提升-webpack-构建资源的速度" data-v-cb1513f6>如何提升 webpack 构建资源的速度</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#更快的-loader-swc" class="sidebar-link reco-side-更快的-loader-swc" data-v-cb1513f6>更快的 loader: swc</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#持久化缓存-cache" class="sidebar-link reco-side-持久化缓存-cache" data-v-cb1513f6>持久化缓存: cache</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#多进程-thread-loader" class="sidebar-link reco-side-多进程-thread-loader" data-v-cb1513f6>多进程: thread-loader</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#如何分析前端打包体积" class="sidebar-link reco-side-如何分析前端打包体积" data-v-cb1513f6>如何分析前端打包体积</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#如何正确地进行分包" class="sidebar-link reco-side-如何正确地进行分包" data-v-cb1513f6>如何正确地进行分包</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#为什么需要分包" class="sidebar-link reco-side-为什么需要分包" data-v-cb1513f6>为什么需要分包？</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#如何更好的分包" class="sidebar-link reco-side-如何更好的分包" data-v-cb1513f6>如何更好的分包？</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#js-代码压缩-minify-的原理是什么" class="sidebar-link reco-side-js-代码压缩-minify-的原理是什么" data-v-cb1513f6>JS 代码压缩 minify 的原理是什么</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#去除多余字符-空格-换行及注释" class="sidebar-link reco-side-去除多余字符-空格-换行及注释" data-v-cb1513f6>去除多余字符: 空格，换行及注释</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#压缩变量名-变量名-函数名及属性名" class="sidebar-link reco-side-压缩变量名-变量名-函数名及属性名" data-v-cb1513f6>压缩变量名：变量名，函数名及属性名</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#解析程序逻辑-合并声明以及布尔值简化" class="sidebar-link reco-side-解析程序逻辑-合并声明以及布尔值简化" data-v-cb1513f6>解析程序逻辑：合并声明以及布尔值简化</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#解析程序逻辑-编译预计算" class="sidebar-link reco-side-解析程序逻辑-编译预计算" data-v-cb1513f6>解析程序逻辑: 编译预计算</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#_15-个-webpack-优化点" class="sidebar-link reco-side-_15-个-webpack-优化点" data-v-cb1513f6>15 个 Webpack 优化点</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#构建时间的优化" class="sidebar-link reco-side-构建时间的优化" data-v-cb1513f6>构建时间的优化</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#打包体积优化" class="sidebar-link reco-side-打包体积优化" data-v-cb1513f6>打包体积优化</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#用户体验优化" class="sidebar-link reco-side-用户体验优化" data-v-cb1513f6>用户体验优化</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#webpack-构建流程" class="sidebar-link reco-side-webpack-构建流程" data-v-cb1513f6>webpack 构建流程</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#开发工具" class="sidebar-link reco-side-开发工具" data-v-cb1513f6>开发工具</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#使用-watch-mode-观察模式" class="sidebar-link reco-side-使用-watch-mode-观察模式" data-v-cb1513f6>使用 watch mode(观察模式)</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#webpack-dev-server" class="sidebar-link reco-side-webpack-dev-server" data-v-cb1513f6>webpack-dev-server</a></li><li class="level-3" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#使用-webpack-dev-middleware" class="sidebar-link reco-side-使用-webpack-dev-middleware" data-v-cb1513f6>使用 webpack-dev-middleware</a></li><li class="level-2" data-v-cb1513f6><a href="/handbook/Webpack/Basic.html#多页应用和单页应用" class="sidebar-link reco-side-多页应用和单页应用" data-v-cb1513f6>多页应用和单页应用</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div></div></div></div>
    <script src="/assets/js/app.824242fd.js" defer></script><script src="/assets/js/4.e4331d91.js" defer></script><script src="/assets/js/3.561be8e5.js" defer></script><script src="/assets/js/2.b25d4684.js" defer></script><script src="/assets/js/1.c7cb60d4.js" defer></script><script src="/assets/js/130.f4438d93.js" defer></script>
  </body>
</html>

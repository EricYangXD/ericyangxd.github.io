---
title: Nginx基础知识
author: EricYangXD
date: "2022-05-09"
---

## Nginx 是什么

Nginx (engine x) 是一个轻量级、高性能的 HTTP 服务器和反向代理服务器，同时也是一个通用代理服务器(TCP/UDP/IMAP/POP3/SMTP)。

### 优势

1. 是一个轻量级、高性能的 HTTP 服务器和反向代理服务器，占用内存少，并发能力强，nginx 的并发能力要比在同类型的网页服务器中表现要好
2. 专为性能优化而开发，最重要的要求便是性能，且十分注重效率，有报告 nginx 能支持高达 50000 个并发连接数

### 正向代理和反向代理

1. 正向代理：局域网中的用户想要直接访问网络是不可行的，只能通过代理服务器（Server）来访问，这种代理服务就被称为正向代理。代理服务器代理的是客户端。
2. 反向代理：客户端无法感知代理，因为客户端访问网络不需要配置，只要把请求发送到反向代理服务器，由反向代理服务器去选择目标服务器获取数据，然后再返回到客户端，此时反向代理服务器和目标服务器对外就是一个服务器，暴露的是代理服务器地址，隐藏了真实服务器 IP 地址。代理服务器代理的是真正的服务端。

### 负载均衡

负载均衡：是高可用网络基础架构的关键组件，通常用于将工作负载分布到多个服务器来提高网站、应用、数据库或其他服务的性能和可靠性。

### 动静分离

常用的 Web 服务器有：TomCat、Nginx。动静分离即把静态资源（如 html、css、图片等）放在一台服务器，把动态资源（后端服务等）放在另外的服务器。

### 常用的命令

-   查看版本：`./nginx -v`
-   启动：`./nginx`
-   关闭：`./nginx -s stop`(推荐) 或 `./nginx -s quit`
-   重新加载 nginx 配置：`./nginx -s reload`

### Nginx 的配置文件

配置文件分为三个模块：

-   全局块：从配置文件开始到 events 块之间，主要是设置一些影响 nginx 服务器整体运行的配置指令。（按道理说：并发处理服务的配置时，值越大，可支持的并发处理量越多，但此时会受到硬件、软件等设备等的制约）
-   events 块：影响 nginx 服务器与用户的网络连接，常用的设置包括是否开启对多 workprocess 下的网络连接进行序列化，是否允许同时接收多个网络连接等等
-   http 块：如反向代理和负载均衡都在此配置

#### location 的匹配规则

共有四种方式：`location[ = | ~ | ~* | ^~ ] url {}`:

1. `=` ：精确匹配，用于不含正则表达式的 url 前，要求字符串与 url 严格匹配，完全相等时，才能停止向下搜索并处理请求
2. `^~`：用于不含正则表达式的 url 前，要求 nginx 服务器找到表示 url 和字符串匹配度最高的 location 后，立即使用此 location 处理请求，而不再匹配
3. `~` ：最佳匹配，用于表示 url 包含正则表达式，并且区分大小写。
4. `~*`：与~一样，只是不区分大小写

注意:

-   如果 url 包含正则表达式，则不需要 ~ 作为开头表示
-   nginx 的匹配具有优先顺序，一旦匹配上就会立马退出，不再进行向下匹配
